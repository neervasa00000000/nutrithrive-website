# NutriThrive URL Structure Consolidation
# Redirect old /pages/ folders to the new clean structure

# Set directory index files
DirectoryIndex index.html index.htm

# Enable rewrite engine
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    
    # Force HTTPS - redirect HTTP to HTTPS
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
    
    # Force non-WWW - redirect www to non-www
    RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
    RewriteRule ^(.*)$ https://%1%{REQUEST_URI} [R=301,L]
    
    # Fix case sensitivity for Image-Enhancer
    RewriteRule ^crazy-ideas/Image-Enhancer/?$ /crazy-ideas/image-enhancer/ [R=301,L]
    RewriteRule ^crazy-ideas/Image-Enhancer/(.*)$ /crazy-ideas/image-enhancer/$1 [R=301,L]
    
    # Blog redirects - redirect ALL /pages/blog/ to /blog/
    # First: Handle /pages/blog/ directory - redirect to /blog/
    RewriteRule ^pages/blog/?$ /blog/ [R=301,L]
    
    # Second: Handle /pages/blog/ URLs with .html extension - redirect to /blog/
    RewriteCond %{REQUEST_URI} ^/pages/blog/(.+\.html)$
    RewriteRule ^pages/blog/(.+\.html)$ /blog/$1 [R=301,L]
    
    # Third: Handle /pages/blog/ URLs without .html - redirect to /blog/ with .html
    RewriteCond %{REQUEST_URI} ^/pages/blog/(.+)$
    RewriteCond %{REQUEST_URI} !\.html$
    RewriteRule ^pages/blog/(.+)$ /blog/$1.html [R=301,L]
    
    # Handle direct /blog/ URLs without .html extension
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} ^/blog/(.+)$
    RewriteCond %{REQUEST_URI} !\.html$
    RewriteCond %{DOCUMENT_ROOT}/blog/%1.html -f
    RewriteRule ^blog/(.+)$ /blog/$1.html [R=301,L]
    
    # Products redirects - redirect all /pages/products/ to /products/
    RewriteRule ^pages/products/(.*)$ /products/$1 [R=301,L]
    RewriteRule ^pages/products/?$ /products/ [R=301,L]
    
    # Clean URL redirects for main pages (without trailing slash)
    RewriteRule ^faq/?$ /pages/faq/faq.html [R=301,L]
    RewriteRule ^contact/?$ /pages/contact/contact.html [R=301,L]
    RewriteRule ^about/?$ /pages/about/about.html [R=301,L]
    
    # Homepage redirect
    RewriteRule ^pages/homepage/(.*)$ /$1 [R=301,L]
    RewriteRule ^pages/homepage/?$ / [R=301,L]
    
    # Fix root-level URLs that Google is trying to access (404 errors)
    RewriteRule ^product-detail\.html$ /products/product-detail.html [R=301,L]
    RewriteRule ^product-black-tea\.html$ /products/product-black-tea.html [R=301,L]
    RewriteRule ^product-curry-leaves\.html$ /products/product-curry-leaves.html [R=301,L]
    RewriteRule ^about\.html$ /pages/about/about.html [R=301,L]
    RewriteRule ^blog\.html$ /blog/ [R=301,L]
    RewriteRule ^thank-you\.html$ /pages/contact/thank-you.html [R=301,L]
    RewriteRule ^how-to-use-moringa\.html$ /pages/usage-guide/how-to-use-moringa.html [R=301,L]
    RewriteRule ^how-to-use-moringa/?$ /pages/usage-guide/how-to-use-moringa.html [R=301,L]
    RewriteRule ^contact\.html$ /pages/contact/contact.html [R=301,L]
    RewriteRule ^moringa-benefits\.html$ /pages/usage-guide/how-to-use-moringa.html [R=301,L]
    RewriteRule ^products\.html$ /products/ [R=301,L]
    
    # Fix incorrect URL paths causing 301 redirects
    RewriteRule ^about/about\.html$ /pages/about/about.html [R=301,L]
    RewriteRule ^contact/contact\.html$ /pages/contact/contact.html [R=301,L]
    RewriteRule ^homepage/index\.html$ / [R=301,L]
    RewriteRule ^homepage/?$ / [R=301,L]
    
    # Fix blog redirects
    RewriteRule ^pages/blog/blog\.html$ /blog/ [R=301,L]
    RewriteRule ^blog/blog\.html\.html$ /blog/ [R=301,L]
    
    # Fix case sensitivity for Image-Enhancer
    RewriteRule ^crazy-ideas/Image-Enhancer/?$ /crazy-ideas/image-enhancer/ [R=301,L]
    RewriteRule ^crazy-ideas/Image-Enhancer/(.*)$ /crazy-ideas/image-enhancer/$1 [R=301,L]
    
    # Clean URL redirects for main pages (without trailing slash)
    RewriteRule ^faq/?$ /pages/faq/faq.html [R=301,L]
    RewriteRule ^contact/?$ /pages/contact/contact.html [R=301,L]
    RewriteRule ^about/?$ /pages/about/about.html [R=301,L]
    
    # Fix double .html.html extensions (Google Search Console errors)
    RewriteRule ^(.+)\.html\.html$ /$1.html [R=301,L]
    
    # Fix /product-detail without .html
    RewriteRule ^product-detail/?$ /products/product-detail.html [R=301,L]
    
    # Redirect non-existent blog posts to actual files
    RewriteRule ^blog/natural-eye-health-supplements-australia\.html$ /blog/moringa-eyesight-better-than-carrots.html [R=301,L]
    RewriteRule ^blog/natural-cholesterol-lowering-supplements-australia-moringa\.html$ /blog/lower-cholesterol-naturally-moringa-heart-health.html [R=301,L]
    RewriteRule ^blog/ultimate-moringa-guide-australia-benefits\.html$ /blog/everything-about-moringa-2025-faq.html [R=301,L]
    RewriteRule ^blog/hidden-veggies-picky-eaters-kids-immunity\.html$ /blog/sneak-greens-into-kids-diet-moringa-hack.html [R=301,L]
    
    # Fix broken image URLs (404 errors from Google Search Console)
    # Redirect old Dried_curry_leaves directory paths to random folder
    RewriteRule ^shared/images/Dried_curry_leaves/Curry3\.png$ /shared/images/random/CURRY3.png [R=301,L]
    RewriteRule ^shared/images/Dried_curry_leaves/Curry2\.png$ /shared/images/random/Curry2.png [R=301,L]
    RewriteRule ^shared/images/Dried_curry_leaves/Curry1\.png$ /shared/images/random/Curry1.png [R=301,L]
    RewriteRule ^shared/images/Dried_curry_leaves/Curry1 .png$ /shared/images/random/Curry1.png [R=301,L]
    RewriteRule ^shared/images/Dried_curry_leaves/4\.png$ /shared/images/random/4.png [R=301,L]
    RewriteRule ^shared/images/Dried_curry_leaves/energy-boosters\.png$ /shared/images/random/energy-boosters.png [R=301,L]
    # Redirect old Moringa directory paths to random folder
    RewriteRule ^shared/images/Moringa%20/Moringa\.png$ /shared/images/random/Moringa.png [R=301,L]
    RewriteRule ^shared/images/Moringa /Moringa\.png$ /shared/images/random/Moringa.png [R=301,L]
    RewriteRule ^shared/images/Moringa/Moringa\.png$ /shared/images/random/Moringa.png [R=301,L]
    RewriteRule ^shared/images/Moringa%20/moringa-hero\.jpg$ /shared/images/random/moringa-hero.jpg [R=301,L]
    RewriteRule ^shared/images/Moringa /moringa-hero\.jpg$ /shared/images/random/moringa-hero.jpg [R=301,L]
    RewriteRule ^shared/images/Moringa/moringa-hero\.jpg$ /shared/images/random/moringa-hero.jpg [R=301,L]
    RewriteRule ^shared/images/Moringa/athletes\.png$ /shared/images/random/athletes.png [R=301,L]
    # Redirect incorrect /blog/shared/images/ paths
    RewriteRule ^blog/shared/images/Moringa/moringa-hero\.jpg$ /shared/images/random/moringa-hero.jpg [R=301,L]
    RewriteRule ^blog/shared/images/Moringa/athletes\.png$ /shared/images/random/athletes.png [R=301,L]
    # Redirect other missing images to appropriate existing images
    RewriteRule ^shared/images/pinterest-diy-hair-growth-oil-australian-ingredients\.jpg$ /shared/images/random/Curry1.png [R=301,L]
    RewriteRule ^shared/images/dried-curry-leaves-cooking-soup\.jpg$ /shared/images/random/Curry1.png [R=301,L]
    RewriteRule ^shared/images/curry-leaf-tea-recipe-australia\.jpg$ /shared/images/random/Curry1.png [R=301,L]
</IfModule>

# Fallback Apache redirects (if mod_rewrite is not available)
# Blog redirects - handle URLs with .html extension first (exact match)
RedirectMatch 301 ^/pages/blog/(.+\.html)$ /blog/$1
# Then handle URLs without .html extension (add .html)
RedirectMatch 301 ^/pages/blog/(.+)$ /blog/$1.html

# Products redirects  
RedirectMatch 301 ^/pages/products/(.*)$ /products/$1

# Homepage redirect
RedirectMatch 301 ^/pages/homepage/(.*)$ /$1

# Fix root-level URLs that Google is trying to access (404 errors)
RedirectMatch 301 ^/product-detail\.html$ /products/product-detail.html
RedirectMatch 301 ^/product-black-tea\.html$ /products/product-black-tea.html
RedirectMatch 301 ^/product-curry-leaves\.html$ /products/product-curry-leaves.html
RedirectMatch 301 ^/about\.html$ /pages/about/about.html
RedirectMatch 301 ^/blog\.html$ /blog/
RedirectMatch 301 ^/thank-you\.html$ /pages/contact/thank-you.html
RedirectMatch 301 ^/how-to-use-moringa\.html$ /pages/usage-guide/how-to-use-moringa.html
RedirectMatch 301 ^/how-to-use-moringa/?$ /pages/usage-guide/how-to-use-moringa.html
RedirectMatch 301 ^/contact\.html$ /pages/contact/contact.html
RedirectMatch 301 ^/moringa-benefits\.html$ /pages/usage-guide/how-to-use-moringa.html
RedirectMatch 301 ^/products\.html$ /products/

# Fix incorrect URL paths causing 301 redirects
RedirectMatch 301 ^/about/about\.html$ /pages/about/about.html
RedirectMatch 301 ^/contact/contact\.html$ /pages/contact/contact.html
RedirectMatch 301 ^/homepage/index\.html$ /
RedirectMatch 301 ^/homepage/?$ /

# Fix blog redirects
RedirectMatch 301 ^/pages/blog/blog\.html$ /blog/
RedirectMatch 301 ^/blog/blog\.html\.html$ /blog/

# Fix double .html.html extensions (Google Search Console errors)
RedirectMatch 301 ^/(.+)\.html\.html$ /$1.html

# Fix /product-detail without .html
RedirectMatch 301 ^/product-detail/?$ /products/product-detail.html

# Redirect non-existent blog posts to actual files
RedirectMatch 301 ^/blog/natural-eye-health-supplements-australia\.html$ /blog/moringa-eyesight-better-than-carrots.html
RedirectMatch 301 ^/blog/natural-cholesterol-lowering-supplements-australia-moringa\.html$ /blog/lower-cholesterol-naturally-moringa-heart-health.html
RedirectMatch 301 ^/blog/ultimate-moringa-guide-australia-benefits\.html$ /blog/everything-about-moringa-2025-faq.html
RedirectMatch 301 ^/blog/hidden-veggies-picky-eaters-kids-immunity\.html$ /blog/sneak-greens-into-kids-diet-moringa-hack.html

# Fix broken image URLs (404 errors from Google Search Console)
# Redirect old Dried_curry_leaves directory paths to random folder
RedirectMatch 301 ^/shared/images/Dried_curry_leaves/Curry3\.png$ /shared/images/random/CURRY3.png
RedirectMatch 301 ^/shared/images/Dried_curry_leaves/Curry2\.png$ /shared/images/random/Curry2.png
RedirectMatch 301 ^/shared/images/Dried_curry_leaves/Curry1\.png$ /shared/images/random/Curry1.png
RedirectMatch 301 ^/shared/images/Dried_curry_leaves/Curry1%20\.png$ /shared/images/random/Curry1.png
RedirectMatch 301 ^/shared/images/Dried_curry_leaves/4\.png$ /shared/images/random/4.png
RedirectMatch 301 ^/shared/images/Dried_curry_leaves/energy-boosters\.png$ /shared/images/random/energy-boosters.png
# Redirect old Moringa directory paths to random folder
RedirectMatch 301 ^/shared/images/Moringa%20/Moringa\.png$ /shared/images/random/Moringa.png
RedirectMatch 301 ^/shared/images/Moringa /Moringa\.png$ /shared/images/random/Moringa.png
RedirectMatch 301 ^/shared/images/Moringa/Moringa\.png$ /shared/images/random/Moringa.png
RedirectMatch 301 ^/shared/images/Moringa%20/moringa-hero\.jpg$ /shared/images/random/moringa-hero.jpg
RedirectMatch 301 ^/shared/images/Moringa /moringa-hero\.jpg$ /shared/images/random/moringa-hero.jpg
RedirectMatch 301 ^/shared/images/Moringa/moringa-hero\.jpg$ /shared/images/random/moringa-hero.jpg
RedirectMatch 301 ^/shared/images/Moringa/athletes\.png$ /shared/images/random/athletes.png
# Redirect incorrect /blog/shared/images/ paths
RedirectMatch 301 ^/blog/shared/images/Moringa/moringa-hero\.jpg$ /shared/images/random/moringa-hero.jpg
RedirectMatch 301 ^/blog/shared/images/Moringa/athletes\.png$ /shared/images/random/athletes.png
# Redirect other missing images to appropriate existing images
RedirectMatch 301 ^/shared/images/pinterest-diy-hair-growth-oil-australian-ingredients\.jpg$ /shared/images/random/Curry1.png
RedirectMatch 301 ^/shared/images/dried-curry-leaves-cooking-soup\.jpg$ /shared/images/random/Curry1.png
RedirectMatch 301 ^/shared/images/curry-leaf-tea-recipe-australia\.jpg$ /shared/images/random/Curry1.png
