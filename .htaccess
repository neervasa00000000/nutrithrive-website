# NutriThrive URL Structure Consolidation
# Redirect old /pages/ folders to the new clean structure

# Set directory index files
DirectoryIndex index.html index.htm

# Enable rewrite engine
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    
    # Blog redirects - redirect ALL /pages/blog/ to /blog/
    # First: Handle /pages/blog/ directory - redirect to /blog/
    RewriteRule ^pages/blog/?$ /blog/ [R=301,L]
    
    # Second: Handle /pages/blog/ URLs with .html extension - redirect to /blog/
    RewriteCond %{REQUEST_URI} ^/pages/blog/(.+\.html)$
    RewriteRule ^pages/blog/(.+\.html)$ /blog/$1 [R=301,L]
    
    # Third: Handle /pages/blog/ URLs without .html - redirect to /blog/ with .html
    RewriteCond %{REQUEST_URI} ^/pages/blog/(.+)$
    RewriteCond %{REQUEST_URI} !\.html$
    RewriteRule ^pages/blog/(.+)$ /blog/$1.html [R=301,L]
    
    # Handle direct /blog/ URLs without .html extension
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} ^/blog/(.+)$
    RewriteCond %{REQUEST_URI} !\.html$
    RewriteCond %{DOCUMENT_ROOT}/blog/%1.html -f
    RewriteRule ^blog/(.+)$ /blog/$1.html [R=301,L]
    
    # Products redirects - redirect all /pages/products/ to /products/
    RewriteRule ^pages/products/(.*)$ /products/$1 [R=301,L]
    RewriteRule ^pages/products/?$ /products/ [R=301,L]
    
    # Homepage redirect
    RewriteRule ^pages/homepage/(.*)$ /$1 [R=301,L]
    RewriteRule ^pages/homepage/?$ / [R=301,L]
</IfModule>

# Fallback Apache redirects (if mod_rewrite is not available)
# Blog redirects - handle URLs with .html extension first (exact match)
RedirectMatch 301 ^/pages/blog/(.+\.html)$ /blog/$1
# Then handle URLs without .html extension (add .html)
RedirectMatch 301 ^/pages/blog/(.+)$ /blog/$1.html

# Products redirects  
RedirectMatch 301 ^/pages/products/(.*)$ /products/$1

# Homepage redirect
RedirectMatch 301 ^/pages/homepage/(.*)$ /$1

# Fix root-level URLs that Google is trying to access (404 errors)
RedirectMatch 301 ^/product-detail\.html$ /products/product-detail.html
RedirectMatch 301 ^/product-black-tea\.html$ /products/product-black-tea.html
RedirectMatch 301 ^/product-curry-leaves\.html$ /products/product-curry-leaves.html
RedirectMatch 301 ^/about\.html$ /pages/about/about.html
RedirectMatch 301 ^/blog\.html$ /blog/
RedirectMatch 301 ^/thank-you\.html$ /pages/contact/thank-you.html
RedirectMatch 301 ^/how-to-use-moringa\.html$ /pages/usage-guide/how-to-use-moringa.html
