<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quick Calendar Reminder | NutriThrive Labs</title>
  <link rel="icon" type="image/png" href="https://i.imgur.com/bZubhoR.png">
  <link rel="apple-touch-icon" href="https://i.imgur.com/bZubhoR.png">
  <link rel="shortcut icon" href="https://i.imgur.com/bZubhoR.png">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --primary: #727D73;
      --primary-dark: #5a645a;
      --primary-light: #8a958a;
      --accent: #AAB99A;
      --accent-light: #c4d0b4;
      --bg-primary: #F0F0D7;
      --bg-secondary: #D0DDD0;
      --bg-tertiary: #ffffff;
      --text-primary: #2d3430;
      --text-secondary: #727D73;
      --text-muted: #AAB99A;
      --border: #D0DDD0;
      --border-dark: #AAB99A;
      --success: #727D73;
      --error: #c85a5a;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-primary);
      min-height: 100vh;
      padding: 0;
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      position: relative;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: 
        radial-gradient(circle at 20% 30%, rgba(170, 185, 154, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(208, 221, 208, 0.2) 0%, transparent 50%);
      z-index: 0;
      pointer-events: none;
      animation: floatBg 20s ease-in-out infinite;
    }

    @keyframes floatBg {
      0%, 100% { transform: translate(0, 0) rotate(0deg); }
      50% { transform: translate(-30px, -30px) rotate(5deg); }
    }

    body::after {
      content: '';
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 400px;
      background: linear-gradient(0deg, var(--bg-secondary) 0%, transparent 100%);
      z-index: 0;
      pointer-events: none;
      opacity: 0.6;
    }

    .container {
      max-width: 1100px;
      width: 100%;
      margin: 0 auto;
      padding: 100px 40px;
      position: relative;
      z-index: 1;
    }

    .header-section {
      text-align: center;
      margin-bottom: 80px;
      position: relative;
      animation: fadeInDown 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .header-section::after {
      content: '';
      position: absolute;
      bottom: -30px;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
      border-radius: 1px;
      opacity: 0.3;
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .header-badge {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 28px;
      background: var(--bg-tertiary);
      border: 2px solid var(--accent);
      border-radius: 50px;
      font-size: 0.8125rem;
      font-weight: 700;
      color: var(--primary);
      text-transform: uppercase;
      letter-spacing: 0.15em;
      margin-bottom: 32px;
      box-shadow: 
        0 4px 12px rgba(114, 125, 115, 0.1);
      position: relative;
      overflow: hidden;
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .header-badge:hover {
      transform: translateY(-2px);
      box-shadow: 
        0 6px 16px rgba(114, 125, 115, 0.15);
      border-color: var(--primary);
    }

    .header-badge::before {
      content: '‚ú®';
      display: inline-block;
      animation: sparkle 2s ease-in-out infinite;
      font-size: 1.1rem;
    }

    .header-badge::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      transition: left 0.6s;
    }

    .header-badge:hover::after {
      left: 100%;
    }

    @keyframes sparkle {
      0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
      50% { transform: scale(1.2) rotate(180deg); opacity: 0.7; }
    }

    .main-content {
      display: grid;
      grid-template-columns: 1.1fr 0.9fr;
      gap: 40px;
      margin-bottom: 60px;
      align-items: start;
    }

    @media (max-width: 768px) {
      .main-content {
        grid-template-columns: 1fr;
        gap: 24px;
      }
    }

    h1 {
      color: var(--primary);
      font-size: 4.5rem;
      margin-bottom: 24px;
      font-weight: 800;
      letter-spacing: -0.06em;
      line-height: 1.05;
      position: relative;
      display: inline-block;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 50%, var(--primary) 100%);
      background-size: 200% 100%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gradientText 4s ease infinite;
    }

    @keyframes gradientText {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    h1::before {
      content: 'üóìÔ∏è';
      display: inline-block;
      margin-right: 20px;
      font-size: 4rem;
      vertical-align: middle;
      animation: calendarFloat 3s ease-in-out infinite;
      position: relative;
      z-index: 1;
    }

    @keyframes calendarFloat {
      0%, 100% { transform: translateY(0) rotate(0deg) scale(1); }
      50% { transform: translateY(-10px) rotate(8deg) scale(1.05); }
    }


    .subtitle {
      color: var(--text-secondary);
      font-size: 1.25rem;
      margin-bottom: 0;
      line-height: 1.8;
      font-weight: 400;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      padding: 0 20px;
      opacity: 0.9;
      animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.3s both;
    }

    .subtitle em {
      color: var(--primary);
      font-style: normal;
      font-weight: 600;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      position: relative;
    }

    .input-card {
      background: linear-gradient(135deg, var(--bg-tertiary) 0%, rgba(255, 255, 255, 0.95) 100%);
      border-radius: 32px;
      padding: 56px;
      box-shadow: 
        0 20px 60px rgba(114, 125, 115, 0.12),
        0 0 0 1px rgba(114, 125, 115, 0.08);
      border: 2px solid var(--border);
      position: relative;
      overflow: hidden;
      animation: cardSlideIn 0.7s cubic-bezier(0.16, 1, 0.3, 1) 0.2s both;
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }

    @keyframes cardSlideIn {
      from {
        opacity: 0;
        transform: translateX(-40px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .input-card:hover {
      transform: translateY(-4px);
      box-shadow: 
        0 24px 80px rgba(114, 125, 115, 0.15),
        0 0 0 1px rgba(114, 125, 115, 0.1);
    }

    .input-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: linear-gradient(90deg, var(--primary), var(--accent), var(--primary));
      background-size: 200% 100%;
      animation: gradientShift 3s ease infinite;
    }

    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .info-card {
      background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(208, 221, 208, 0.75) 50%, rgba(240, 240, 215, 0.5) 100%);
      border-radius: 32px;
      padding: 56px;
      box-shadow: 
        0 20px 60px rgba(114, 125, 115, 0.1),
        0 0 0 1px rgba(114, 125, 115, 0.08);
      border: 2px solid var(--border-dark);
      position: relative;
      animation: cardSlideIn 0.7s cubic-bezier(0.16, 1, 0.3, 1) 0.4s both;
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .info-card:hover {
      transform: translateY(-4px);
      box-shadow: 
        0 24px 80px rgba(114, 125, 115, 0.13),
        0 0 0 1px rgba(114, 125, 115, 0.1);
    }

    .input-label {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 0.875rem;
      font-weight: 700;
      color: var(--primary);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      margin-bottom: 16px;
      text-align: left;
    }

    .input-label::before {
      content: '‚úçÔ∏è';
      font-size: 1.2rem;
      animation: write 2s ease-in-out infinite;
    }

    @keyframes write {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-10deg); }
      75% { transform: rotate(10deg); }
    }

    textarea {
      width: 100%;
      min-height: 220px;
      padding: 32px;
      font-size: 1.1875rem;
      border-radius: 24px;
      border: 2px solid var(--border-dark);
      margin-bottom: 32px;
      outline: none;
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      font-family: inherit;
      resize: vertical;
      background: var(--bg-secondary);
      color: var(--text-primary);
      box-shadow: 
        inset 0 2px 4px rgba(114, 125, 115, 0.06);
      line-height: 2;
      position: relative;
    }

    textarea:focus {
      border-color: var(--primary);
      background: var(--bg-tertiary);
      box-shadow: 
        0 0 0 4px rgba(114, 125, 115, 0.1),
        inset 0 2px 4px rgba(114, 125, 115, 0.04);
      transform: translateY(-2px);
      border-width: 2.5px;
    }

    textarea::placeholder {
      color: var(--text-muted);
      opacity: 0.6;
    }

    .button-group {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    button {
      flex: 1;
      min-width: 200px;
      padding: 22px 48px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      color: white;
      border: none;
      border-radius: 18px;
      font-size: 0.9375rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      box-shadow: 
        0 8px 24px rgba(114, 125, 115, 0.25);
      letter-spacing: 0.06em;
      position: relative;
      overflow: hidden;
      text-transform: uppercase;
    }

    @keyframes buttonGradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    button::after {
      content: '‚ú®';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      font-size: 1.5rem;
      transition: transform 0.3s ease;
      pointer-events: none;
    }

    button:hover::after {
      transform: translate(-50%, -50%) scale(1);
      animation: sparklePop 0.6s ease;
    }

    @keyframes sparklePop {
      0% { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(2) rotate(360deg); opacity: 0; }
    }

    button::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    button:hover::before {
      width: 400px;
      height: 400px;
    }

    button:hover {
      background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
      box-shadow: 
        0 12px 32px rgba(114, 125, 115, 0.3);
      transform: translateY(-3px);
    }

    button:active {
      transform: translateY(-1px);
      box-shadow: 
        0 6px 20px rgba(114, 125, 115, 0.3),
        0 0 0 4px rgba(114, 125, 115, 0.15);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
      background: var(--border);
    }

    .result {
      margin: 24px 0;
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .result-section {
      margin-top: 32px;
    }

    .event-summary {
      background: var(--bg-tertiary);
      border-left: 4px solid var(--primary);
      padding: 36px;
      border-radius: 24px;
      text-align: left;
      font-size: 1.0625rem;
      margin-bottom: 28px;
      color: var(--text-primary);
      box-shadow: 
        0 8px 24px rgba(114, 125, 115, 0.1),
        0 0 0 1px rgba(114, 125, 115, 0.08);
      animation: slideInLeft 0.6s cubic-bezier(0.16, 1, 0.3, 1);
      border: 2px solid var(--border);
      position: relative;
      overflow: hidden;
    }

    .event-summary::after {
      content: 'üéâ';
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 2rem;
      opacity: 0.2;
      animation: celebrate 2s ease-in-out infinite;
    }

    @keyframes celebrate {
      0%, 100% { transform: scale(1) rotate(0deg); }
      50% { transform: scale(1.2) rotate(15deg); }
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(-30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .event-summary b {
      color: var(--primary);
      font-weight: 700;
      font-size: 0.8125rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      display: block;
      margin-bottom: 8px;
      margin-top: 12px;
    }

    .event-summary b:first-child {
      margin-top: 0;
    }

    .event-summary br {
      margin-bottom: 8px;
      display: block;
      content: "";
    }

    .ics-link {
      display: inline-flex;
      align-items: center;
      gap: 12px;
      margin: 28px 0;
      padding: 18px 44px;
      background: var(--accent);
      color: var(--primary);
      border-radius: 16px;
      font-weight: 700;
      text-decoration: none;
      box-shadow: 
        0 6px 20px rgba(170, 185, 154, 0.25);
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      font-size: 0.875rem;
      letter-spacing: 0.05em;
      border: 2px solid var(--accent);
      text-transform: uppercase;
      position: relative;
      overflow: hidden;
    }

    .ics-link::before {
      content: 'üì•';
      font-size: 1.3rem;
      transition: transform 0.3s ease;
    }

    .ics-link:hover::before {
      transform: translateY(-3px) rotate(10deg);
    }

    .ics-link:hover {
      background: var(--accent-light);
      box-shadow: 
        0 8px 24px rgba(170, 185, 154, 0.3);
      transform: translateY(-3px);
      border-color: var(--primary);
    }

    .ics-link:active {
      transform: translateY(-1px);
      box-shadow: 
        0 6px 20px rgba(170, 185, 154, 0.3),
        0 0 0 4px rgba(170, 185, 154, 0.15);
    }

    .info-section {
      margin-top: 48px;
    }

    .tip {
      color: var(--text-secondary);
      background: var(--bg-tertiary);
      font-size: 0.9375rem;
      padding: 28px 32px;
      border-radius: 20px;
      border: 2px solid var(--border-dark);
      text-align: left;
      box-shadow: 
        0 4px 12px rgba(114, 125, 115, 0.08),
        0 0 0 1px rgba(114, 125, 115, 0.05);
      line-height: 1.9;
      position: relative;
      padding-left: 64px;
      margin-bottom: 32px;
      transition: all 0.3s ease;
    }

    .tip:hover {
      transform: translateY(-2px);
      box-shadow: 
        0 6px 16px rgba(114, 125, 115, 0.1),
        0 0 0 1px rgba(114, 125, 115, 0.08);
    }

    .tip::before {
      content: 'üí°';
      position: absolute;
      left: 24px;
      top: 28px;
      font-size: 1.8rem;
      animation: lightbulb 2s ease-in-out infinite;
    }

    @keyframes lightbulb {
      0%, 100% { transform: scale(1) rotate(0deg); }
      50% { transform: scale(1.1) rotate(-5deg); }
    }

    .tip strong {
      color: var(--primary);
      font-weight: 700;
    }

    .error {
      color: var(--error);
      margin: 24px 0;
      font-weight: 600;
      padding: 24px 28px;
      border-radius: 16px;
      background: var(--bg-tertiary);
      border: 2px solid var(--error);
      border-left: 4px solid var(--error);
      text-align: left;
      box-shadow: 
        0 4px 12px rgba(200, 90, 90, 0.1),
        0 0 0 1px rgba(200, 90, 90, 0.08);
      line-height: 1.8;
      font-size: 0.9375rem;
      position: relative;
      padding-left: 56px;
    }

    .error::before {
      content: '‚ö†Ô∏è';
      position: absolute;
      left: 20px;
      top: 24px;
      font-size: 1.5rem;
    }

    .examples {
      background: var(--bg-tertiary);
      padding: 32px;
      border-radius: 20px;
      text-align: left;
      box-shadow: 
        0 4px 12px rgba(114, 125, 115, 0.08),
        0 0 0 1px rgba(114, 125, 115, 0.05);
      border: 2px solid var(--border);
      margin-top: 32px;
    }

    .examples h3 {
      color: var(--primary);
      font-size: 0.875rem;
      margin-bottom: 24px;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      display: flex;
      align-items: center;
      gap: 12px;
      padding-bottom: 16px;
      border-bottom: 2px solid var(--border-dark);
    }

    .examples h3::before {
      content: 'üìù';
      font-size: 1.4rem;
    }

    .examples ul {
      list-style: none;
      padding: 0;
      display: grid;
      gap: 12px;
    }

    .examples li {
      color: var(--text-secondary);
      font-size: 0.9375rem;
      padding: 16px 20px;
      padding-left: 56px;
      position: relative;
      line-height: 1.8;
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(240, 240, 215, 0.4) 100%);
      border-radius: 12px;
      border: 2px solid var(--border);
      cursor: pointer;
    }

    .examples li:hover {
      color: var(--primary);
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
      transform: translateX(6px) scale(1.02);
      border-color: var(--accent);
      box-shadow: 
        0 4px 12px rgba(114, 125, 115, 0.15),
        0 0 0 2px rgba(170, 185, 154, 0.2);
    }

    .examples li:active {
      transform: translateX(3px) scale(0.98);
    }

    .examples li:before {
      content: "‚ú®";
      position: absolute;
      left: 20px;
      color: var(--accent);
      font-size: 1.1em;
      transition: transform 0.3s ease;
    }

    .examples li:hover:before {
      transform: rotate(15deg) scale(1.2);
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.8s linear infinite;
      margin-right: 8px;
      vertical-align: middle;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @media (max-width: 768px) {
      .container {
        padding: 32px 20px;
      }

      h1 {
        font-size: 2.5rem;
      }

      .subtitle {
        font-size: 1rem;
      }

      .input-card,
      .info-card {
        padding: 28px 24px;
      }

      textarea {
        min-height: 140px;
        padding: 20px;
      }

      button {
        width: 100%;
        min-width: auto;
      }

      .ics-link {
        width: 100%;
        justify-content: center;
      }

      .event-summary {
        padding: 24px;
      }

      .tip,
      .error {
        padding-left: 48px;
      }
    }

    @media (max-width: 480px) {
      .container {
        padding: 24px 16px;
      }

      h1 {
        font-size: 2rem;
      }

      .header-badge {
        font-size: 0.75rem;
        padding: 6px 16px;
      }

      .input-card,
      .info-card {
        padding: 24px 20px;
      }
    }
  </style>
  <script>
    // Simple date parser - no external dependencies
    const SimpleDateParser = {
      parse: function(text, refDate) {
        refDate = refDate || new Date();
        const now = new Date(refDate);
        const textLower = text.toLowerCase().trim();
        
        // Patterns for common date/time expressions
        const patterns = [
          // "tomorrow at 3pm"
          {
            regex: /tomorrow\s+(?:at\s+)?(\d{1,2})(?::(\d{2}))?\s*(am|pm)?/i,
            handler: function(match) {
              const date = new Date(now);
              date.setDate(date.getDate() + 1);
              return this.parseTime(date, match[1], match[2] || '0', match[3]);
            }
          },
          // "next monday/tuesday/etc at 3pm"
          {
            regex: /next\s+(monday|tuesday|wednesday|thursday|friday|saturday|sunday)\s+(?:at\s+)?(\d{1,2})(?::(\d{2}))?\s*(am|pm)?/i,
            handler: function(match) {
              const dayNames = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
              const targetDay = dayNames.indexOf(match[1].toLowerCase());
              const date = new Date(now);
              const currentDay = date.getDay();
              let daysAhead = targetDay - currentDay;
              if (daysAhead <= 0) daysAhead += 7;
              date.setDate(date.getDate() + daysAhead);
              return this.parseTime(date, match[2], match[3] || '0', match[4]);
            }
          },
          // "Dec 25 2025 at 6pm" or "25 Dec 2025 6pm"
          {
            regex: /(?:(\w{3,9})\s+)?(\d{1,2})(?:\s+(\w{3,9}))?\s+(\d{4})\s+(?:at\s+)?(\d{1,2})(?::(\d{2}))?\s*(am|pm)?/i,
            handler: function(match) {
              const months = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'];
              let month, day, year, hour, minute, ampm;
              
              if (match[1]) {
                // "Dec 25 2025"
                month = months.findIndex(m => m.startsWith(match[1].toLowerCase()));
                day = parseInt(match[2]);
                year = parseInt(match[4]);
                hour = parseInt(match[5] || '12');
                minute = parseInt(match[6] || '0');
                ampm = match[7];
              } else {
                // "25 Dec 2025"
                day = parseInt(match[2]);
                month = months.findIndex(m => m.startsWith(match[3].toLowerCase()));
                year = parseInt(match[4]);
                hour = parseInt(match[5] || '12');
                minute = parseInt(match[6] || '0');
                ampm = match[7];
              }
              
              const date = new Date(year, month, day);
              return this.parseTime(date, hour, minute, ampm);
            }
          },
          // "friday 2:30pm" or "friday at 2:30pm"
          {
            regex: /(monday|tuesday|wednesday|thursday|friday|saturday|sunday)\s+(?:at\s+)?(\d{1,2})(?::(\d{2}))?\s*(am|pm)/i,
            handler: function(match) {
              const dayNames = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
              const targetDay = dayNames.indexOf(match[1].toLowerCase());
              const date = new Date(now);
              const currentDay = date.getDay();
              let daysAhead = targetDay - currentDay;
              if (daysAhead <= 0) daysAhead += 7;
              date.setDate(date.getDate() + daysAhead);
              return this.parseTime(date, match[2], match[3] || '0', match[4]);
            }
          },
          // "in 2 hours" or "2 hours from now"
          {
            regex: /(?:in\s+)?(\d+)\s+hours?\s+(?:from\s+now)?/i,
            handler: function(match) {
              const date = new Date(now);
              date.setHours(date.getHours() + parseInt(match[1]));
              return { start: { date: () => date } };
            }
          }
        ];
        
        for (const pattern of patterns) {
          const match = text.match(pattern.regex);
          if (match) {
            try {
              const result = pattern.handler.call(this, match);
              if (result && result.start) return [result];
            } catch (e) {
              console.error('Parse error:', e);
            }
          }
        }
        
        return [];
      },
      
      parseTime: function(date, hour, minute, ampm) {
        hour = parseInt(hour);
        minute = parseInt(minute || '0');
        
        if (ampm) {
          if (ampm.toLowerCase() === 'pm' && hour !== 12) hour += 12;
          if (ampm.toLowerCase() === 'am' && hour === 12) hour = 0;
        } else if (hour < 12) {
          // Default to PM if no am/pm specified and hour < 12
          hour += 12;
        }
        
        date.setHours(hour, minute, 0, 0);
        return { start: { date: () => date } };
      }
    };
    
    // Make it available globally
    window.chrono = {
      parse: function(text, refDate, options) {
        return SimpleDateParser.parse(text, refDate);
      }
    };
    
    // Enable button immediately since we don't need external library
    window.addEventListener('load', function() {
      const btn = document.getElementById('generateBtn');
      if (btn) {
        btn.disabled = false;
        btn.innerHTML = 'Generate Calendar Event';
      }
    });
  </script>
</head>
<body>
  <div class="container">
    <div class="header-section">
      <div class="header-badge">Quick Reminder Tool</div>
      <h1>Calendar Reminder</h1>
      <p class="subtitle">
        Type naturally and we'll create your calendar event. Try: <em>"Lunch next Thursday 2:30pm"</em> or <em>"Dentist Dec 4 2025 8:15am"</em>
      </p>
    </div>

    <div class="main-content">
      <div class="input-card">
        <label class="input-label">Your Reminder</label>
        <textarea 
          id="eventText" 
          placeholder="e.g., Team meeting tomorrow at 3pm in Conference Room A"
          autofocus
        ></textarea>
        <div class="button-group">
          <button id="generateBtn" onclick="generateCalendar()">
            Generate Event
          </button>
        </div>
        <div class="result" id="result"></div>
      </div>

      <div class="info-card">
        <div class="tip">
          <strong>Tip:</strong> Download the .ics file and open it in Google Calendar, Apple Calendar, Outlook, or any calendar app. The event will be added automatically!
        </div>

        <div class="examples">
          <h3>Examples</h3>
          <ul>
            <li>Doctor appointment next Monday at 10am</li>
            <li>Birthday party Dec 25 2025 6pm</li>
            <li>Gym session tomorrow 7am</li>
            <li>Conference call Friday 2:30pm</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <script>
    // No need for loading checks - parser is built-in

    // Allow Enter key to submit (Ctrl/Cmd + Enter)
    document.getElementById('eventText').addEventListener('keydown', function(e) {
      if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
        generateCalendar();
      }
    });

    function generateCalendar() {
      const text = document.getElementById("eventText").value.trim();
      const resultDiv = document.getElementById("result");
      const generateBtn = document.getElementById("generateBtn");

      resultDiv.innerHTML = "";
      generateBtn.disabled = true;
      generateBtn.innerHTML = '<span class="loading"></span>Processing...';

      // Check if text is empty
      if (!text) {
        resultDiv.innerHTML = '<div class="error">‚ö†Ô∏è Please describe your event or reminder.</div>';
        setTimeout(function() {
          generateBtn.disabled = false;
          generateBtn.innerHTML = 'Generate Event';
        }, 100);
        return;
      }

      // Parser is always available (built-in)

      try {
        // Parse using chrono-node with current date as reference
        const now = new Date();
        const results = chrono.parse(text, now, { forwardDate: true });

        if (!results || results.length === 0 || !results[0].start) {
          resultDiv.innerHTML = '<div class="error">‚ö†Ô∏è Could not extract date/time from your text.<br><br>Try being more specific:<br>‚Ä¢ "Meeting tomorrow at 3pm"<br>‚Ä¢ "Appointment Dec 15 2025 at 2:30pm"<br>‚Ä¢ "Event next Friday 10am"</div>';
          setTimeout(function() {
            generateBtn.disabled = false;
            generateBtn.innerHTML = 'Generate Event';
          }, 100);
          return;
        }

        const parsedResult = results[0];
        const evStart = parsedResult.start.date();
        
        // Validate that the date is in the future or today
        if (evStart < new Date(now.getTime() - 60000)) {
          resultDiv.innerHTML = '<div class="error">‚ö†Ô∏è The date/time you entered appears to be in the past. Please enter a future date.</div>';
          setTimeout(function() {
            generateBtn.disabled = false;
            generateBtn.innerHTML = 'Generate Event';
          }, 100);
          return;
        }

        // Get end time
        let evEnd = null;
        let hasEnd = false;
        
        if (parsedResult.end && parsedResult.end.date()) {
          evEnd = parsedResult.end.date();
          hasEnd = true;
        } else {
          // Default: 1 hour duration
          evEnd = new Date(evStart.getTime() + 60 * 60 * 1000);
        }

        // Extract location if "at <location>" is present
        let location = "";
        const locMatch = text.match(/\bat\s+([A-Za-z0-9 ,.'-]+?)(?:\s+(?:at|on|next|tomorrow|today|monday|tuesday|wednesday|thursday|friday|saturday|sunday|\d{1,2}[:\d]{0,5}\s*(?:am|pm)|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|\d{4}))/i);
        
        if (locMatch && locMatch[1]) {
          location = locMatch[1].trim();
          // Clean up common false positives
          if (location.toLowerCase().match(/^(at|on|next|tomorrow|today|monday|tuesday|wednesday|thursday|friday|saturday|sunday)$/i)) {
            location = "";
          }
        }

        // If no location found with "at", try other patterns
        if (!location) {
          const locPatterns = [
            /\bin\s+([A-Za-z0-9 ,.'-]+?)(?:\s+(?:at|on|next|tomorrow|today))/i,
            /\blocation[:\s]+([A-Za-z0-9 ,.'-]+)/i
          ];
          
          for (const pattern of locPatterns) {
            const match = text.match(pattern);
            if (match && match[1]) {
              location = match[1].trim();
              break;
            }
          }
        }

        // Extract summary (remove date/time/location from original text)
        let summary = text;
        
        if (parsedResult.text) {
          summary = text.replace(parsedResult.text, "").trim();
          
          // Remove location patterns
          if (location) {
            summary = summary.replace(new RegExp(`\\s*at\\s+${location.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')}`, 'i'), '');
            summary = summary.replace(new RegExp(`\\s*in\\s+${location.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')}`, 'i'), '');
          }
          
          summary = summary.trim();
        }

        // If summary is empty or too short, use a default
        if (!summary || summary.length < 2) {
          summary = "Reminder";
        }

        // Clean up summary
        summary = summary.replace(/\s+/g, ' ').trim();

        // ICS formatting function
        function fmtICS(dt) {
          if (!dt || !(dt instanceof Date) || isNaN(dt.getTime())) {
            throw new Error("Invalid date");
          }
          
          // Format as UTC YYYYMMDDTHHmmssZ
          const z = new Date(dt.getTime() - dt.getTimezoneOffset() * 60000);
          const yyyy = z.getUTCFullYear();
          const mm = String(z.getUTCMonth() + 1).padStart(2, "0");
          const dd = String(z.getUTCDate()).padStart(2, "0");
          const h = String(z.getUTCHours()).padStart(2, "0");
          const m = String(z.getUTCMinutes()).padStart(2, "0");
          const s = String(z.getUTCSeconds()).padStart(2, "0");
          
          return `${yyyy}${mm}${dd}T${h}${m}${s}Z`;
        }

        // Generate ICS content
        const icsContent = [
          "BEGIN:VCALENDAR",
          "VERSION:2.0",
          "CALSCALE:GREGORIAN",
          "PRODID:-//NutriThrive Labs//Quick Calendar Reminder//EN",
          "BEGIN:VEVENT",
          "UID:" + Date.now() + "-" + Math.random().toString(36).substr(2, 9) + "@nutrithrive.com.au",
          "DTSTAMP:" + fmtICS(new Date()),
          "SUMMARY:" + summary.replace(/\n/g, " ").replace(/[,;\\]/g, "\\$&"),
          "DTSTART:" + fmtICS(evStart),
          "DTEND:" + fmtICS(evEnd),
          location ? "LOCATION:" + location.replace(/\n/g, " ").replace(/[,;\\]/g, "\\$&") : "",
          "DESCRIPTION:" + text.replace(/\n/g, " ").replace(/[,;\\]/g, "\\$&"),
          "STATUS:CONFIRMED",
          "SEQUENCE:0",
          "END:VEVENT",
          "END:VCALENDAR"
        ].filter(line => line !== "").join("\r\n");

        // Format dates for display
        const formatDate = (date) => {
          return date.toLocaleDateString('en-AU', { 
            weekday: 'long', 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric' 
          });
        };

        const formatTime = (date) => {
          return date.toLocaleTimeString('en-AU', { 
            hour: '2-digit', 
            minute: '2-digit',
            hour12: true 
          });
        };

        // Create download link
        const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        
        const html = `
          <div class="event-summary">
            <b>üìå Title:</b> ${escapeHtml(summary)}<br><br>
            <b>üìÖ Date:</b> ${formatDate(evStart)}<br>
            <b>‚è∞ Time:</b> ${formatTime(evStart)} - ${formatTime(evEnd)}<br>
            ${location ? `<b>üìç Location:</b> ${escapeHtml(location)}<br>` : ''}
            <b>üìù Description:</b> ${escapeHtml(text)}
          </div>
          <a href="${url}" download="reminder-${Date.now()}.ics" class="ics-link" onclick="this.href = '${url}'">
            üì• Download Calendar Event (.ics)
          </a>
        `;

        resultDiv.innerHTML = html;
        
        // Always reset button state
        setTimeout(function() {
          generateBtn.disabled = false;
          generateBtn.innerHTML = 'Generate Event';
        }, 100);

        // Clean up URL after a delay
        setTimeout(() => {
          URL.revokeObjectURL(url);
        }, 10000);

      } catch (error) {
        console.error('Error generating calendar:', error);
        resultDiv.innerHTML = '<div class="error">‚ö†Ô∏è An error occurred while processing your request. Please try again with a different format.</div>';
        
        // Always reset button state
        setTimeout(function() {
          generateBtn.disabled = false;
          generateBtn.innerHTML = 'Generate Event';
        }, 100);
      }
    }

    // Escape HTML to prevent XSS
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Auto-focus textarea on load
    window.addEventListener('load', function() {
      document.getElementById('eventText').focus();
    });

    // Make example items clickable - fill textarea when clicked
    document.querySelectorAll('.examples li').forEach(function(li) {
      li.addEventListener('click', function() {
        const text = this.textContent.trim();
        const textarea = document.getElementById('eventText');
        textarea.value = text;
        textarea.focus();
        // Add visual feedback
        this.style.transform = 'scale(0.95)';
        setTimeout(() => {
          this.style.transform = '';
        }, 150);
      });
    });
  </script>
</body>
</html>

