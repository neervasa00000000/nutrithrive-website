<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Photo Palette & Mood Analyzer | NutriThrive Quick Tools</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Extract dominant colors from any photo and analyze its mood. Perfect for design inspiration.">
  <link rel="icon" type="image/png" href="https://i.imgur.com/bZubhoR.png">
  <link rel="apple-touch-icon" href="https://i.imgur.com/bZubhoR.png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #1B3C53;
      --primary-light: #234C6A;
      --secondary: #456882;
      --accent: #D2C1B6;
      --bg: #D2C1B6;
      --text: #1B3C53;
      --text-light: #456882;
      --white: #ffffff;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, var(--bg) 0%, var(--secondary) 100%);
      color: var(--text);
      min-height: 100vh;
      padding: 2rem 1rem;
      line-height: 1.6;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: var(--white);
      border: 3px solid var(--primary);
      border-radius: 24px;
      padding: 3rem 2.5rem;
      position: relative;
      overflow: hidden;
    }

    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 50%, var(--secondary) 100%);
    }

    h1 {
      font-size: 2.25rem;
      font-weight: 800;
      color: var(--primary);
      margin-bottom: 0.5rem;
      text-align: center;
      letter-spacing: -1px;
      line-height: 1.2;
    }

    .subtitle {
      text-align: center;
      color: var(--text-light);
      font-size: 1rem;
      margin-bottom: 2.5rem;
      font-weight: 500;
    }

    .upload-section {
      text-align: center;
      margin-bottom: 2.5rem;
    }

    .upload-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1rem 2.5rem;
      background: var(--primary);
      color: var(--white);
      border: 3px solid var(--primary);
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .upload-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .upload-btn:hover::before {
      width: 300px;
      height: 300px;
    }

    .upload-btn:hover {
      background: var(--primary-light);
      border-color: var(--primary-light);
      transform: translateY(-2px);
    }

    .upload-btn:active {
      transform: translateY(0);
    }

    input[type="file"] {
      display: none;
    }

    .image-section {
      margin: 2.5rem 0;
      text-align: center;
    }

    .image-wrapper {
      display: inline-block;
      position: relative;
      border-radius: 16px;
      overflow: hidden;
      border: 3px solid var(--accent);
      background: var(--bg);
      padding: 0.5rem;
    }

    #canvas {
      max-width: 100%;
      height: auto;
      display: block;
      border-radius: 12px;
    }

    .palette-section {
      margin: 3rem 0;
    }

    .section-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 1.5rem;
      text-align: center;
      letter-spacing: -0.5px;
    }

    .palette-row {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 1.25rem;
      margin-bottom: 2rem;
    }

    .swatch-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.75rem;
    }

    .swatch {
      width: 80px;
      height: 80px;
      border-radius: 16px;
      border: 3px solid var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .swatch:hover {
      transform: scale(1.1) rotate(5deg);
      border-color: var(--secondary);
    }

    .swatch::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, transparent 100%);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .swatch:hover::after {
      opacity: 1;
    }

    .color-label {
      font-size: 0.85rem;
      font-weight: 700;
      color: var(--primary);
      text-align: center;
      font-family: 'Courier New', monospace;
      letter-spacing: 0.5px;
    }

    .color-info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 2rem;
    }

    .color-card {
      padding: 1.25rem;
      background: var(--bg);
      border: 2px solid var(--secondary);
      border-radius: 12px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .color-card:hover {
      border-color: var(--primary);
      transform: translateY(-4px);
      background: var(--white);
    }

    .color-hex {
      font-weight: 800;
      color: var(--primary);
      font-family: 'Courier New', monospace;
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
      letter-spacing: 1px;
    }

    .color-name {
      color: var(--text-light);
      font-size: 0.95rem;
      font-weight: 600;
    }

    .mood-section {
      margin: 3rem 0;
      padding: 2rem;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      border-radius: 16px;
      text-align: center;
      color: var(--white);
    }

    .mood-label {
      font-size: 0.85rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 2px;
      opacity: 0.9;
      margin-bottom: 0.75rem;
    }

    .mood-title {
      font-size: 2rem;
      font-weight: 800;
      margin-bottom: 0.5rem;
      letter-spacing: -1px;
    }

    .mood-desc {
      font-size: 1.1rem;
      opacity: 0.95;
      font-weight: 500;
    }

    .empty-state {
      text-align: center;
      padding: 4rem 2rem;
      color: var(--text-light);
    }

    .empty-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    .empty-text {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text);
    }

    .credit {
      text-align: center;
      margin-top: 2.5rem;
      padding-top: 2rem;
      border-top: 2px solid var(--accent);
      color: var(--text-light);
      font-size: 0.9rem;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in {
      animation: fadeIn 0.5s ease-out;
    }

    @media (max-width: 640px) {
      body {
        padding: 1rem 0.5rem;
      }

      .container {
        padding: 2rem 1.5rem;
        border-radius: 20px;
      }

      h1 {
        font-size: 1.75rem;
      }

      .subtitle {
        font-size: 0.9rem;
      }

      .upload-btn {
        padding: 0.875rem 2rem;
        font-size: 1rem;
      }

      .swatch {
        width: 65px;
        height: 65px;
      }

      .color-info-grid {
        grid-template-columns: 1fr;
      }

      .mood-title {
        font-size: 1.5rem;
      }

      .mood-desc {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Photo Palette & Mood Analyzer</h1>
    <p class="subtitle">Extract colors and discover the mood of any image</p>

    <div class="upload-section">
      <label class="upload-btn">
        <span>ðŸ“¸</span>
        <span>Select a Photo</span>
      </label>
      <input type="file" id="photoInput" accept="image/*"/>
    </div>

    <div class="image-section">
      <div class="image-wrapper">
        <canvas id="canvas" width="500" height="400"></canvas>
      </div>
    </div>

    <div id="palette" class="palette-section">
      <div class="empty-state">
        <div class="empty-icon">ðŸŽ¨</div>
        <div class="empty-text">Upload a photo to extract its color palette</div>
      </div>
    </div>

    <div id="mood" class="mood-section" style="display: none;"></div>

    <div class="credit">Palette and mood analysis for design inspiration</div>
  </div>

  <script>
    // Color extraction helper
    function getDominantColors(imgData, num = 5) {
      let pixels = [];
      
      for (let i = 0; i < imgData.data.length; i += 4) {
        let r = imgData.data[i];
        let g = imgData.data[i + 1];
        let b = imgData.data[i + 2];
        let a = imgData.data[i + 3];
        
        if (a > 200) {
          pixels.push([r, g, b]);
        }
      }

      // Simple clustering algorithm
      let clusters = [];
      
      pixels.forEach(p => {
        let found = false;
        for (let c of clusters) {
          if (Math.abs(c[0] - p[0]) < 28 && 
              Math.abs(c[1] - p[1]) < 28 && 
              Math.abs(c[2] - p[2]) < 28) {
            c[0] = (c[0] * c[3] + p[0]) / (c[3] + 1);
            c[1] = (c[1] * c[3] + p[1]) / (c[3] + 1);
            c[2] = (c[2] * c[3] + p[2]) / (c[3] + 1);
            c[3]++;
            found = true;
            break;
          }
        }
        if (!found) {
          clusters.push([p[0], p[1], p[2], 1]);
        }
      });

      // Sort by population
      clusters = clusters.sort((a, b) => b[3] - a[3]);

      return clusters.slice(0, num).map(c => {
        const rgb = [Math.round(c[0]), Math.round(c[1]), Math.round(c[2])];
        return {
          rgb,
          hex: "#" + rgb.map(v => v.toString(16).padStart(2, '0')).join('').toUpperCase()
        };
      });
    }

    // Mood matching
    function getPaletteMood(palette) {
      if (!palette.length) return { main: "No colours found", desc: "" };

      let hsum = 0, ssum = 0, lsum = 0;

      palette.forEach(({ rgb }) => {
        let [r, g, b] = rgb.map(x => x / 255);
        let mx = Math.max(r, g, b);
        let mn = Math.min(r, g, b);
        let l = (mx + mn) / 2;
        let s = mx == mn ? 0 : (l < 0.5 ? (mx - mn) / (mx + mn) : (mx - mn) / (2 - mx - mn));
        
        let h;
        if (mx == mn) h = 0;
        else if (mx == r) h = (g - b) / (mx - mn);
        else if (mx == g) h = 2 + (b - r) / (mx - mn);
        else h = 4 + (r - g) / (mx - mn);
        
        h = ((h * 60 + 360) % 360) / 360;
        hsum += h;
        ssum += s;
        lsum += l;
      });

      hsum /= palette.length;
      ssum /= palette.length;
      lsum /= palette.length;

      if (lsum > 0.78) return { main: "Bright & Energetic", desc: "Uplifting, lively" };
      if (lsum < 0.29) return { main: "Moody & Deep", desc: "Dramatic, mysterious" };
      if (ssum > 0.51 && hsum > 0.85) return { main: "Vivid & Playful", desc: "Cheerful, cute" };
      if (ssum < 0.22) return { main: "Muted & Calm", desc: "Subtle, soft" };
      if (hsum > 0.11 && hsum < 0.30) return { main: "Fresh & Natural", desc: "Green, outdoorsy" };
      if (hsum > 0.54 && hsum < 0.70) return { main: "Sky & Tranquil", desc: "Cool, relaxed" };
      
      return { main: "Colorful Harmony", desc: "Balanced, creative" };
    }

    // Named color matching
    const namedColors = [
      { name: "Black", hex: "#000000" },
      { name: "White", hex: "#FFFFFF" },
      { name: "Red", hex: "#FF0000" },
      { name: "Lime", hex: "#00FF00" },
      { name: "Blue", hex: "#0000FF" },
      { name: "Yellow", hex: "#FFFF00" },
      { name: "Cyan", hex: "#00FFFF" },
      { name: "Magenta", hex: "#FF00FF" },
      { name: "Gray", hex: "#808080" },
      { name: "Orange", hex: "#FFA500" },
      { name: "Purple", hex: "#800080" },
      { name: "Pink", hex: "#FFC0CB" },
      { name: "Brown", hex: "#A52A2A" },
      { name: "Gold", hex: "#FFD700" },
      { name: "Teal", hex: "#008080" },
      { name: "Sky Blue", hex: "#87CEEB" },
      { name: "Indigo", hex: "#4B0082" },
      { name: "Coral", hex: "#FF7F50" },
      { name: "Navy", hex: "#000080" },
      { name: "Maroon", hex: "#800000" },
      { name: "Olive", hex: "#808000" },
      { name: "Lavender", hex: "#E6E6FA" },
      { name: "Salmon", hex: "#FA8072" },
      { name: "Turquoise", hex: "#40E0D0" },
      { name: "Beige", hex: "#F5F5DC" },
      { name: "Khaki", hex: "#F0E68C" },
      { name: "Crimson", hex: "#DC143C" },
      { name: "Plum", hex: "#DDA0DD" },
      { name: "Mint", hex: "#98FB98" },
      { name: "Peach", hex: "#FFE5B4" }
    ];

    function hexToRgb(hex) {
      hex = hex.replace(/^#/, '');
      let bigint = parseInt(hex, 16);
      return [(bigint >> 16) & 255, (bigint >> 8) & 255, bigint & 255];
    }

    function getDistance(rgb1, rgb2) {
      return Math.sqrt(
        Math.pow(rgb1[0] - rgb2[0], 2) +
        Math.pow(rgb1[1] - rgb2[1], 2) +
        Math.pow(rgb1[2] - rgb2[2], 2)
      );
    }

    function closestName(rgb) {
      let closest = namedColors[0];
      let minDist = getDistance(rgb, hexToRgb(closest.hex));
      
      for (let color of namedColors) {
        let dist = getDistance(rgb, hexToRgb(color.hex));
        if (dist < minDist) {
          closest = color;
          minDist = dist;
        }
      }
      
      return closest;
    }

    // UI handlers
    const photoInput = document.getElementById('photoInput');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    photoInput.onchange = function(e) {
      const file = e.target.files[0];
      if (!file) return;

      const img = new window.Image();
      
      img.onload = function() {
        // Fit image to canvas
        let ratio = Math.min(canvas.width / img.width, canvas.height / img.height, 1);
        let w = img.width * ratio;
        let h = img.height * ratio;
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, (canvas.width - w) / 2, (canvas.height - h) / 2, w, h);

        // Extract palette
        let imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const palette = getDominantColors(imgData, 5);

        // Build palette display
        let paletteHTML = '<div class="section-title fade-in">Dominant Colors</div>';
        paletteHTML += '<div class="palette-row fade-in">';
        
        palette.forEach((c, index) => {
          let name = closestName(c.rgb);
          paletteHTML += `
            <div class="swatch-wrapper fade-in" style="animation-delay: ${index * 0.1}s">
              <div class="swatch" style="background: ${c.hex}" title="${c.hex}"></div>
              <div class="color-label">${c.hex}</div>
            </div>
          `;
        });
        
        paletteHTML += '</div>';

        // Build color info cards
        paletteHTML += '<div class="color-info-grid fade-in">';
        palette.forEach((c, index) => {
          let name = closestName(c.rgb);
          paletteHTML += `
            <div class="color-card fade-in" style="animation-delay: ${index * 0.1}s">
              <div class="color-hex">${c.hex}</div>
              <div class="color-name">${name.name}</div>
            </div>
          `;
        });
        paletteHTML += '</div>';

        document.getElementById('palette').innerHTML = paletteHTML;

        // Display mood
        const mood = getPaletteMood(palette);
        const moodSection = document.getElementById('mood');
        moodSection.style.display = 'block';
        moodSection.className = 'mood-section fade-in';
        moodSection.innerHTML = `
          <div class="mood-label">Mood Analysis</div>
          <div class="mood-title">${mood.main}</div>
          <div class="mood-desc">${mood.desc}</div>
        `;
      };

      img.src = URL.createObjectURL(file);
    };
  </script>
</body>
</html>
