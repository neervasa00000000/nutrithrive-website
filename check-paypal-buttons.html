<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PayPal Button Diagnostic Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f5f5;
            padding: 2rem;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2d5a3d;
            margin-bottom: 1rem;
        }
        .summary {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 2rem;
        }
        .summary h2 {
            color: #856404;
            margin-bottom: 0.5rem;
        }
        .blog-list {
            margin-top: 2rem;
        }
        .blog-item {
            background: #f8f9fa;
            border-left: 4px solid #dc3545;
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 4px;
        }
        .blog-item.working {
            border-left-color: #28a745;
        }
        .blog-item h3 {
            color: #333;
            margin-bottom: 0.5rem;
        }
        .blog-item a {
            color: #0066cc;
            text-decoration: none;
            font-weight: 600;
        }
        .blog-item a:hover {
            text-decoration: underline;
        }
        .button-info {
            margin-top: 0.5rem;
            padding: 0.5rem;
            background: white;
            border-radius: 4px;
        }
        .button-id {
            font-family: monospace;
            background: #e9ecef;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            display: inline-block;
            margin-right: 0.5rem;
        }
        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }
        .status-badge.problem {
            background: #f8d7da;
            color: #721c24;
        }
        .status-badge.working {
            background: #d4edda;
            color: #155724;
        }
        .instructions {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            padding: 1.5rem;
            border-radius: 4px;
            margin-top: 2rem;
        }
        .instructions h2 {
            color: #0c5460;
            margin-bottom: 1rem;
        }
        .instructions ol {
            margin-left: 1.5rem;
        }
        .instructions li {
            margin-bottom: 0.5rem;
        }
        .button-ids-summary {
            margin-top: 1rem;
            padding: 1rem;
            background: #fff;
            border-radius: 4px;
        }
        .button-ids-summary h3 {
            margin-bottom: 0.5rem;
        }
        .button-id-item {
            padding: 0.5rem;
            margin: 0.25rem 0;
            background: #f8f9fa;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç PayPal Button Diagnostic Report</h1>
        
        <div class="summary">
            <h2>Summary</h2>
            <p><strong>Total Blog Posts with PayPal Buttons:</strong> <span id="total-blogs">0</span></p>
            <p><strong>Not Collecting Shipping Address:</strong> <span id="problem-blogs">0</span> ‚ùå</p>
            <p><strong>Working Correctly:</strong> <span id="working-blogs">0</span> ‚úÖ</p>
        </div>

        <div class="button-ids-summary">
            <h3>PayPal Button IDs That Need Fixing:</h3>
            <div id="button-ids-list"></div>
        </div>

        <div class="blog-list">
            <h2>Blog Posts with PayPal Buttons</h2>
            <div id="blog-list"></div>
        </div>

        <div class="instructions">
            <h2>How to Fix the Issue</h2>
            <ol>
                <li><strong>Log into PayPal Business Dashboard</strong> at <a href="https://www.paypal.com/businessmanage/account/buttons" target="_blank">https://www.paypal.com/businessmanage/account/buttons</a></li>
                <li><strong>Find each Button ID</strong> listed above (e.g., ERYQAP7ZAHDDQ, NJKU46NBZ55JN, etc.)</li>
                <li><strong>Edit each button</strong> and enable <strong>"Require shipping address"</strong> or <strong>"Collect shipping address"</strong></li>
                <li><strong>Save and republish</strong> each button</li>
                <li><strong>Test</strong> by placing a test order from one of the blog posts</li>
            </ol>
            <p style="margin-top: 1rem;"><strong>Note:</strong> The cart.html page uses PayPal Buttons API (not hosted buttons) and has been fixed to collect shipping addresses. Only the blog posts using hosted buttons need to be fixed in the PayPal dashboard.</p>
        </div>
    </div>

    <script>
        // Blog posts with PayPal buttons and their status
        const blogPosts = [
            {
                file: "blog/musashi-protein-powder-australia-comprehensive-guide-2026.html",
                title: "Musashi Protein Powder Australia Comprehensive Guide 2026",
                url: "/blog/musashi-protein-powder-australia-comprehensive-guide-2026.html",
                buttons: [
                    { id: "ERYQAP7ZAHDDQ", product: "Moringa Powder", count: 6 },
                    { id: "NJKU46NBZ55JN", product: "Curry Leaves", count: 1 },
                    { id: "ASMMMWXFS7X84", product: "Combo Pack", count: 1 }
                ],
                type: "PayPal Hosted Buttons (form-based)",
                status: "problem"
            },
            {
                file: "blog/why-australians-cant-sleep-moringa-midnight-reset.html",
                title: "Why Australians Can't Sleep - Moringa Midnight Reset",
                url: "/blog/why-australians-cant-sleep-moringa-midnight-reset.html",
                buttons: [
                    { id: "ERYQAP7ZAHDDQ", product: "Moringa Powder", count: 5 }
                ],
                type: "PayPal Hosted Buttons (form-based)",
                status: "problem"
            },
            {
                file: "blog/moringa-brands-reviewed-australia-2025-verdict.html",
                title: "Moringa Brands Reviewed Australia 2025 Verdict",
                url: "/blog/moringa-brands-reviewed-australia-2025-verdict.html",
                buttons: [
                    { id: "ERYQAP7ZAHDDQ", product: "Moringa Powder", count: 1 }
                ],
                type: "PayPal Hosted Buttons (form-based)",
                status: "problem"
            },
            {
                file: "blog/black-tea-benefits-caffeine-australia.html",
                title: "Black Tea Benefits Caffeine Australia",
                url: "/blog/black-tea-benefits-caffeine-australia.html",
                buttons: [
                    { id: "AMDLXGV7HCKXW", product: "Black Tea", count: 2 }
                ],
                type: "PayPal Hosted Buttons (JavaScript API)",
                status: "problem"
            },
            {
                file: "blog/darjeeling-black-tea-melbourne-muscatel-marvel.html",
                title: "Darjeeling Black Tea Melbourne Muscatel Marvel",
                url: "/blog/darjeeling-black-tea-melbourne-muscatel-marvel.html",
                buttons: [
                    { id: "AMDLXGV7HCKXW", product: "Black Tea", count: 1 }
                ],
                type: "PayPal Hosted Buttons (JavaScript API)",
                status: "problem"
            },
            {
                file: "blog/the-2026-moringa-market-disruption-chemical-free-superfood-power.html",
                title: "The 2026 Moringa Market Disruption",
                url: "/blog/the-2026-moringa-market-disruption-chemical-free-superfood-power.html",
                buttons: [],
                type: "Apple Pay (via PayPal)",
                status: "working"
            }
        ];

        // Get unique button IDs
        const buttonIds = new Set();
        blogPosts.forEach(blog => {
            blog.buttons.forEach(btn => buttonIds.add(btn.id));
        });

        // Render the report
        function renderReport() {
            const blogListDiv = document.getElementById('blog-list');
            const buttonIdsDiv = document.getElementById('button-ids-list');
            const totalBlogs = blogPosts.length;
            const problemBlogs = blogPosts.filter(b => b.status === 'problem').length;
            const workingBlogs = blogPosts.filter(b => b.status === 'working').length;

            document.getElementById('total-blogs').textContent = totalBlogs;
            document.getElementById('problem-blogs').textContent = problemBlogs;
            document.getElementById('working-blogs').textContent = workingBlogs;

            // Render blog list
            blogListDiv.innerHTML = blogPosts.map(blog => {
                const statusClass = blog.status === 'working' ? 'working' : '';
                const statusBadge = blog.status === 'working' 
                    ? '<span class="status-badge working">‚úÖ WORKING</span>'
                    : '<span class="status-badge problem">‚ùå NOT COLLECTING ADDRESS</span>';
                
                const buttonsHtml = blog.buttons.length > 0
                    ? blog.buttons.map(btn => `
                        <div class="button-info">
                            <span class="button-id">${btn.id}</span>
                            <strong>${btn.product}</strong> - ${btn.count} button${btn.count > 1 ? 's' : ''}
                        </div>
                    `).join('')
                    : '<div class="button-info"><em>Uses Apple Pay (collects shipping address)</em></div>';

                return `
                    <div class="blog-item ${statusClass}">
                        <h3>
                            <a href="${blog.url}" target="_blank">${blog.title}</a>
                            ${statusBadge}
                        </h3>
                        <p><strong>Type:</strong> ${blog.type}</p>
                        ${buttonsHtml}
                    </div>
                `;
            }).join('');

            // Render button IDs summary
            buttonIdsDiv.innerHTML = Array.from(buttonIds).map(id => {
                const blogsUsing = blogPosts.filter(b => 
                    b.buttons.some(btn => btn.id === id)
                );
                return `
                    <div class="button-id-item">
                        <strong class="button-id">${id}</strong>
                        Used in ${blogsUsing.length} blog post${blogsUsing.length > 1 ? 's' : ''}: 
                        ${blogsUsing.map(b => b.title).join(', ')}
                    </div>
                `;
            }).join('');
        }

        renderReport();
    </script>
</body>
</html>